<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="It will take about 10 minutes to finish reading this article.  1. DescriptionIn Swift, async and await are keywords used for asynchronous programming, a cleaner, more readable way to handle asynchrono">
<meta property="og:type" content="article">
<meta property="og:title" content="01. Async and Await">
<meta property="og:url" content="https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/index.html">
<meta property="og:site_name" content="iOS Hunter Notes">
<meta property="og:description" content="It will take about 10 minutes to finish reading this article.  1. DescriptionIn Swift, async and await are keywords used for asynchronous programming, a cleaner, more readable way to handle asynchrono">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-08-23T08:00:00.000Z">
<meta property="article:modified_time" content="2023-08-23T18:33:47.071Z">
<meta property="article:author" content="Zitao">
<meta property="article:tag" content="async">
<meta property="article:tag" content="await">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>01. Async and Await</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/categories">Categories</a></li><!--
     --><!--
       --><li><a href="/tags">Tags</a></li><!--
     --><!--
       --><li><a href="/search">Search</a></li><!--
     --><!--
       --><li><a href="/archives">Archives</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/zitao0206">Projects</a></li><!--
     --><!--
       --><li><a href="/about">Others</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/08/31/iOS/05.%20Projects%20&%20Issues/00.%20%20An%20investigation%20of%20Lost%20location%20Issue/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/08/19/Swift/00.%20Tips/09.%20How%20to%20use%20rethrows%20in%20Swift?/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&text=01. Async and Await"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&is_video=false&description=01. Async and Await"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=01. Async and Await&body=Check out this article: https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&name=01. Async and Await&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&t=01. Async and Await"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Description"><span class="toc-number">1.</span> <span class="toc-text">1. Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-How-to-use-async-and-await"><span class="toc-number">2.</span> <span class="toc-text">2. How to use async and await</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Application-of-async-await"><span class="toc-number">3.</span> <span class="toc-text">3. Application of async-await</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Conversion-between-asynchronous-and-synchronous-functions"><span class="toc-number">4.</span> <span class="toc-text">4. Conversion between asynchronous and synchronous functions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        01. Async and Await
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Zitao</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-08-23T08:00:00.000Z" class="dt-published" itemprop="datePublished">2023-08-23</time>
        
        (Updated: <time datetime="2023-08-23T18:33:47.071Z" class="dt-updated" itemprop="dateModified">2023-08-23</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Swift/">Swift</a> › <a class="category-link" href="/categories/Swift/07-Concurrency/">07. Concurrency</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/async/" rel="tag">async</a>, <a class="p-category" href="/tags/await/" rel="tag">await</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><font color=gray size=2><em>It will take about 10 minutes to finish reading this article.</em></font></p>
<!-- # **<font size=5 >Async and Await</font>** -->
<h4 id="1-Description"><a href="#1-Description" class="headerlink" title="1. Description"></a><font size=3 color=#4169E1>1. Description</font></h4><p>In Swift, async and await are keywords used for asynchronous programming, a cleaner, more readable way to handle asynchronous tasks. These are new features introduced in Swift 5.5 that make asynchronous code look more like synchronous code, and the use of async&#x2F;await also naturally preserves the semantic structure of the code, providing the necessary support for at least three horizontal improvements:<br>(1) Better performance for asynchronous code.<br>(2) Better tools that provide a more consistent experience when debugging, profiling, and exploring code.<br>(3) A foundation for future concurrency features.<br>In short, they improve the maintainability and understandability of code.</p>
<h4 id="2-How-to-use-async-and-await"><a href="#2-How-to-use-async-and-await" class="headerlink" title="2. How to use async and await"></a><font size=3 color=#4169E1>2. How to use async and await</font></h4><p><font size=3 color=#4169E1><strong>2.1 async</strong></font><br>A function can be declared as asynchronous by prefixing the return arrow of the function declaration with the async keyword:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">loadSignature</span>() <span class="keyword">async</span> <span class="keyword">throws</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> signature <span class="operator">=</span> <span class="keyword">try</span> <span class="keyword">await</span> simulateSignatureLoading()</span><br><span class="line">        <span class="keyword">return</span> signature</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="type">CustomError</span>.loadingError</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>An asynchronous function can pause execution when it encounters the await keyword and wait for an asynchronous operation to complete before resuming execution. </p>
<p><font size=3 color=#4169E1><strong>2.2 await</strong></font><br>Await is a keyword used to call asynchronous methods. When await is encountered, the execution of the function pauses until the asynchronous operation completes and returns the result.<br>Here’s an example of using await to call an asynchronous function and wait for its result: </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">simulateSignatureLoading</span>() <span class="keyword">async</span> <span class="keyword">throws</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="comment">// Simulate some asynchronous loading process, eg, from a network request or a file.</span></span><br><span class="line">    <span class="keyword">await</span> <span class="type">Task</span>.sleep(<span class="number">2_000_000_000</span>) <span class="comment">// Simulate a 2-second delay</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> success <span class="operator">=</span> <span class="type">Bool</span>.random() <span class="comment">// Simulate successful or unsuccessful loading</span></span><br><span class="line">    <span class="keyword">if</span> success &#123;</span><br><span class="line">        <span class="keyword">let</span> signature <span class="operator">=</span> <span class="string">&quot;This is my signature&quot;</span></span><br><span class="line">        <span class="keyword">return</span> signature</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="type">CustomError</span>.signatureNotFound</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Suspension mentioned above:<br>(1) The suspension is the method, not the thread that executes the method.<br>(2) Accurately await should be called a potential suspension point, not a suspension point, because not all await will be suspended, only encountered similar IO, manually start a sub-thread, etc. will suspend the current call stack.<br>(3) Before and after the pause point may occur before and after the thread switch, it is because of the asynchronous method before and after the pause point may change the thread of execution, so in the asynchronous method should be careful to use locks, semaphores and other synchronization operations.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> lock <span class="operator">=</span> <span class="type">NSLock</span>.<span class="keyword">init</span>()</span><br><span class="line"><span class="keyword">func</span> <span class="title function_">test</span>() <span class="keyword">async</span> &#123;</span><br><span class="line">  lock.lock()</span><br><span class="line">  <span class="keyword">try?</span> <span class="keyword">await</span> <span class="type">Task</span>.sleep(nanoseconds: <span class="number">1_000_000_000</span>)</span><br><span class="line">  lock.unlock()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span><span class="number">10</span> &#123;</span><br><span class="line">  <span class="type">Task</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> test()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Code like the above generates a deadlock at lock.lock(), as does switching to a semaphore.<br>Note:<br> async-await is often used companionally in Swift and can be thought of as simply this:<br>“await is always waiting for a response from its partner, async.”</p>
<h4 id="3-Application-of-async-await"><a href="#3-Application-of-async-await" class="headerlink" title="3. Application of async-await"></a><font size=3 color=#4169E1>3. Application of async-await</font></h4><p><font size=3 color=#4169E1><strong>3.1 Replaces traditional closure callbacks (Asynchronous serial)</strong></font><br>Traditional closure callbacks are common in Swift for returning from an asynchronous task, usually in combination with a parameter of type result, as follows:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">fetchImages</span>(<span class="params">completion</span>: ([<span class="type">UIImage</span>]<span class="operator">?</span>, <span class="type">Error</span>?) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    <span class="comment">// .. Execution of data requests</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Or</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">fetchImages</span>(<span class="params">completion</span>: (<span class="type">Result</span>&lt;[<span class="type">UIImage</span>], <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    <span class="comment">// .. Execution of data requests</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>While this approach is still common, it can have several drawbacks:<br>(1) You have to make sure you call completion closures in every possible exit method.<br>(2) Closure code is often too deeply nested, optional types must be unwrapped, etc., making it harder to read and debug.<br>(3) You need to use weak references to avoid circular references.<br>(4) Implementers need to switch on results to get results (Block callbacks) and cannot use try catch statements from the implementation level.<br>The fetchImages function above can simply be replaced with async&#x2F;await as:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">fetchImages</span>() <span class="keyword">async</span> <span class="keyword">throws</span> -&gt; [<span class="type">UIImage</span>] &#123;</span><br><span class="line">    <span class="comment">// Simulate asynchronous operations, such as requesting image data from the web</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> withCheckedThrowingContinuation &#123; continuation <span class="keyword">in</span></span><br><span class="line">        <span class="type">DispatchQueue</span>.global().async &#123;</span><br><span class="line">            <span class="comment">// Perform an asynchronous operation to get images and errors</span></span><br><span class="line">            <span class="keyword">let</span> images: [<span class="type">UIImage</span>] <span class="operator">=</span> []</span><br><span class="line">            <span class="keyword">let</span> error: <span class="type">Error</span>? <span class="operator">=</span> <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> error <span class="operator">=</span> error &#123;</span><br><span class="line">                continuation.resume(throwing: error)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                continuation.resume(returning: images)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">func</span> <span class="title function_">imagesData</span>() &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> images <span class="operator">=</span> <span class="keyword">try</span> <span class="keyword">await</span> fetchImages()</span><br><span class="line">        <span class="comment">// This is where the fetched images are processed</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="comment">// Handling error</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Task</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> imagesData()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>Note 1:</strong><br>When adopting async-await in an existing project, you should be careful not to break all the code at once. When doing such a large-scale refactoring, it’s best to consider maintaining the old implementation for the time being so that you don’t have to update all the code until you know if the new implementation is stable enough.<br>Example:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">ImageFetcher</span> &#123;</span><br><span class="line">    <span class="keyword">@available</span>(<span class="operator">*</span>, renamed: <span class="string">&quot;fetchImages()&quot;</span>)</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">fetchImages</span>(<span class="params">completion</span>: (<span class="type">Result</span>&lt;[<span class="type">UIImage</span>], <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">fetchImages</span>() <span class="keyword">async</span> <span class="keyword">throws</span> -&gt; [<span class="type">UIImage</span>] &#123;</span><br><span class="line">        <span class="comment">// .. Execution of data requests</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The asynchronous alternative refactoring option is added here, which still retains the old implementation, but adds an available attribute. If you want Xcode’s deprecation warning, you can change it to:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@available</span>(<span class="operator">*</span>, deprecated, renamed: <span class="string">&quot;fetchImages()&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>This way you can optimize your code incrementally without having to refactor your entire project at once.</p>
<p><strong>Note 2:</strong><br>In the above code, the Result enumeration is also optimized together. Yes, async-await can greatly reduce the use of Result enumerations.</p>
<p><font size=3 color=#4169E1><strong>3.2 async-let (asynchronous parallelism)</strong></font><br>Let’s take a look at the following application for async-await:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">fetchImage</span>(<span class="params">from</span> <span class="params">url</span>: <span class="type">URL</span>) <span class="keyword">async</span> <span class="keyword">throws</span> -&gt; <span class="type">UIImage</span> &#123;</span><br><span class="line">    <span class="comment">// Simulate asynchronous downloading of images</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;fetchImage----- begin <span class="subst">\(Thread.current)</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> <span class="type">Task</span>.sleep(<span class="number">1_000_000_000</span>) <span class="comment">// Simulates 1 second download time</span></span><br><span class="line">    <span class="keyword">let</span> data <span class="operator">=</span> <span class="keyword">try</span> <span class="keyword">await</span> <span class="type">URLSession</span>.shared.data(from: url)</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> image <span class="operator">=</span> <span class="type">UIImage</span>(data: data) <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="type">NSError</span>(domain: <span class="string">&quot;ImageDownloadError&quot;</span>, code: <span class="number">0</span>, userInfo: [NSLocalizedDescriptionKey: <span class="string">&quot;Failed to download image&quot;</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;fetchImage----- end <span class="subst">\(Thread.current)</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">downloadImages</span>() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> imageURLs <span class="operator">=</span> [</span><br><span class="line">        <span class="type">URL</span>(string: <span class="string">&quot;https://example.com/image1.jpg&quot;</span>)<span class="operator">!</span>,</span><br><span class="line">        <span class="type">URL</span>(string: <span class="string">&quot;https://example.com/image2.jpg&quot;</span>)<span class="operator">!</span>,</span><br><span class="line">        <span class="type">URL</span>(string: <span class="string">&quot;https://example.com/image3.jpg&quot;</span>)<span class="operator">!</span></span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> image1 <span class="operator">=</span> <span class="keyword">await</span> fetchImage(from: imageURLs[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Downloaded image 1:&quot;</span>, image1)</span><br><span class="line">        <span class="keyword">let</span> image2 <span class="operator">=</span> <span class="keyword">await</span> fetchImage(from: imageURLs[<span class="number">1</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Downloaded image 2:&quot;</span>, image2)</span><br><span class="line">        <span class="keyword">let</span> image3 <span class="operator">=</span> <span class="keyword">await</span> fetchImage(from: imageURLs[<span class="number">2</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Downloaded image 3:&quot;</span>, image3)</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Task</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> downloadImages()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The 3 images in the example are downloaded serially one by one, using async-let can optimize this code for asynchronous parallelism:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">func</span> <span class="title function_">downloadImages</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> imageURLs <span class="operator">=</span> [</span><br><span class="line">        <span class="type">URL</span>(string: <span class="string">&quot;https://example.com/image1.jpg&quot;</span>)<span class="operator">!</span>,</span><br><span class="line">        <span class="type">URL</span>(string: <span class="string">&quot;https://example.com/image2.jpg&quot;</span>)<span class="operator">!</span>,</span><br><span class="line">        <span class="type">URL</span>(string: <span class="string">&quot;https://example.com/image3.jpg&quot;</span>)<span class="operator">!</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">var</span> images: [<span class="type">UIImage</span>] <span class="operator">=</span> []</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 1 <span class="subst">\(Thread.current)</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">let</span> fetchImage1 <span class="operator">=</span> fetchImage(from: imageURLs[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">let</span> fetchImage2 <span class="operator">=</span> fetchImage(from: imageURLs[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">let</span> fetchImage3 <span class="operator">=</span> fetchImage(from: imageURLs[<span class="number">2</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 2 <span class="subst">\(Thread.current)</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">let</span> (image1, image2, image3) <span class="operator">=</span> <span class="keyword">await</span> (<span class="keyword">try</span> fetchImage1, <span class="keyword">try</span> fetchImage2, <span class="keyword">try</span> fetchImage3)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 3 <span class="subst">\(Thread.current)</span>&quot;</span>)</span><br><span class="line">        images.append(contentsOf: [image1, image2, image3])</span><br><span class="line">     &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      </span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The result of the Print:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="number">1</span> <span class="operator">&lt;</span>_NSMainThread: <span class="number">0x7b10000003c0</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">1</span>, name <span class="operator">=</span> main&#125;</span><br><span class="line"><span class="operator">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="number">2</span> <span class="operator">&lt;</span>_NSMainThread: <span class="number">0x7b10000003c0</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">1</span>, name <span class="operator">=</span> main&#125;</span><br><span class="line">fetchImage<span class="operator">-----</span> begin <span class="operator">&lt;</span><span class="type">NSThread</span>: <span class="number">0x7b1000043a40</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">6</span>, name <span class="operator">=</span> (null)&#125;</span><br><span class="line">fetchImage<span class="operator">-----</span> begin <span class="operator">&lt;</span><span class="type">NSThread</span>: <span class="number">0x7b1000046200</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">7</span>, name <span class="operator">=</span> (null)&#125;</span><br><span class="line">fetchImage<span class="operator">-----</span> begin <span class="operator">&lt;</span><span class="type">NSThread</span>: <span class="number">0x7b1000046200</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">7</span>, name <span class="operator">=</span> (null)&#125;</span><br><span class="line">fetchImage<span class="operator">-----</span> begin <span class="operator">&lt;</span><span class="type">NSThread</span>: <span class="number">0x7b1000043a40</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">6</span>, name <span class="operator">=</span> (null)&#125;</span><br><span class="line">fetchImage<span class="operator">-----</span> end <span class="operator">&lt;</span><span class="type">NSThread</span>: <span class="number">0x7b100004b700</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">3</span>, name <span class="operator">=</span> (null)&#125;</span><br><span class="line">fetchImage<span class="operator">-----</span> end <span class="operator">&lt;</span><span class="type">NSThread</span>: <span class="number">0x7b1000048ac0</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">4</span>, name <span class="operator">=</span> (null)&#125;</span><br><span class="line">fetchImage<span class="operator">-----</span> end <span class="operator">&lt;</span><span class="type">NSThread</span>: <span class="number">0x7b100004b700</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">3</span>, name <span class="operator">=</span> (null)&#125;</span><br><span class="line">fetchImage<span class="operator">-----</span> end <span class="operator">&lt;</span><span class="type">NSThread</span>: <span class="number">0x7b1000046200</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">7</span>, name <span class="operator">=</span> (null)&#125;</span><br><span class="line"><span class="operator">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="number">3</span> <span class="operator">&lt;</span>_NSMainThread: <span class="number">0x7b10000003c0</span><span class="operator">&gt;</span>&#123;number <span class="operator">=</span> <span class="number">1</span>, name <span class="operator">=</span> main&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong><br>After modifying the image with async-let, fetchImage hangs, and the thread continues to perform other tasks until it encounters await, and fetchImage will not execute, which is why print2 executes before fetchImage. So async-let is a concurrent binding mechanism to achieve asynchronous concurrency.</p>
<h4 id="4-Conversion-between-asynchronous-and-synchronous-functions"><a href="#4-Conversion-between-asynchronous-and-synchronous-functions" class="headerlink" title="4. Conversion between asynchronous and synchronous functions"></a><font size=3 color=#4169E1>4. Conversion between asynchronous and synchronous functions</font></h4><p>Asynchronous function types differ from synchronous function types. However, there exists an implicit conversion from a synchronous function type to the corresponding asynchronous function type. The approximate rules for combining ‘throw’ are as follows:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">FunctionTypes</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> syncNonThrowing: () -&gt; <span class="type">Void</span></span><br><span class="line">  <span class="keyword">var</span> syncThrowing: () <span class="keyword">throws</span> -&gt; <span class="type">Void</span></span><br><span class="line">  <span class="keyword">var</span> asyncNonThrowing: () <span class="keyword">async</span> -&gt; <span class="type">Void</span></span><br><span class="line">  <span class="keyword">var</span> asyncThrowing: () <span class="keyword">async</span> <span class="keyword">throws</span> -&gt; <span class="type">Void</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">demonstrateConversions</span>() &#123;</span><br><span class="line">    <span class="comment">// Okay to add &#x27;async&#x27; and/or &#x27;throws&#x27;    </span></span><br><span class="line">    asyncNonThrowing <span class="operator">=</span> syncNonThrowing</span><br><span class="line">    asyncThrowing <span class="operator">=</span> syncThrowing</span><br><span class="line">    syncThrowing <span class="operator">=</span> syncNonThrowing</span><br><span class="line">    asyncThrowing <span class="operator">=</span> asyncNonThrowing</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Error to remove &#x27;async&#x27; or &#x27;throws&#x27;</span></span><br><span class="line">    syncNonThrowing <span class="operator">=</span> asyncNonThrowing <span class="comment">// error</span></span><br><span class="line">    syncThrowing <span class="operator">=</span> asyncThrowing       <span class="comment">// error</span></span><br><span class="line">    syncNonThrowing <span class="operator">=</span> syncThrowing     <span class="comment">// error</span></span><br><span class="line">    asyncNonThrowing <span class="operator">=</span> syncThrowing    <span class="comment">// error</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As you can see above, basically synchronous functions can be converted to asynchronous functions, but it doesn’t work the other way around.</p>
<h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><font size=3 color=gray><em>Reference</em></font></h4><p>[1] <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2191310">https://cloud.tencent.com/developer/article/2191310</a><br>[2] <a target="_blank" rel="noopener" href="https://juejin.cn/post/7025261081291407373">https://juejin.cn/post/7025261081291407373</a><br>[3] <a target="_blank" rel="noopener" href="https://juejin.cn/post/7076733264798416926">https://juejin.cn/post/7076733264798416926</a><br>[4] <a target="_blank" rel="noopener" href="https://github.com/apple/swift-evolution/blob/main/proposals/0296-async-await.md">https://github.com/apple/swift-evolution/blob/main/proposals/0296-async-await.md</a>     </p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/categories">Categories</a></li>
        
          <li><a href="/tags">Tags</a></li>
        
          <li><a href="/search">Search</a></li>
        
          <li><a href="/archives">Archives</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/zitao0206">Projects</a></li>
        
          <li><a href="/about">Others</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Description"><span class="toc-number">1.</span> <span class="toc-text">1. Description</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-How-to-use-async-and-await"><span class="toc-number">2.</span> <span class="toc-text">2. How to use async and await</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Application-of-async-await"><span class="toc-number">3.</span> <span class="toc-text">3. Application of async-await</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Conversion-between-asynchronous-and-synchronous-functions"><span class="toc-number">4.</span> <span class="toc-text">4. Conversion between asynchronous and synchronous functions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&text=01. Async and Await"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&is_video=false&description=01. Async and Await"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=01. Async and Await&body=Check out this article: https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&title=01. Async and Await"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&name=01. Async and Await&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zitao0206.github.io/2023/08/23/Swift/07.%20Concurrency/01.%20Async%20and%20Await/&t=01. Async and Await"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2033
    Zitao
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/categories">Categories</a></li><!--
     --><!--
       --><li><a href="/tags">Tags</a></li><!--
     --><!--
       --><li><a href="/search">Search</a></li><!--
     --><!--
       --><li><a href="/archives">Archives</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/zitao0206">Projects</a></li><!--
     --><!--
       --><li><a href="/about">Others</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
