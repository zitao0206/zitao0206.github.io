<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="It will take about 10 minutes to finish reading this article. Here is a summary of all the possible reasons for publishing failure in Hexo. 1. BackgroundThere was once such a requirement scenario, whe">
<meta property="og:type" content="article">
<meta property="og:title" content="01. How to use iOS Geofencing in your business?">
<meta property="og:url" content="https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/">
<meta property="og:site_name" content="iOS Hunter Notes">
<meta property="og:description" content="It will take about 10 minutes to finish reading this article. Here is a summary of all the possible reasons for publishing failure in Hexo. 1. BackgroundThere was once such a requirement scenario, whe">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/000.png">
<meta property="og:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/001.png">
<meta property="og:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/002.png">
<meta property="og:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/003.png">
<meta property="og:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/004.png">
<meta property="og:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/005.png">
<meta property="og:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/006.png">
<meta property="og:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/007.png">
<meta property="article:published_time" content="2023-10-06T10:00:00.000Z">
<meta property="article:modified_time" content="2023-12-15T14:25:13.041Z">
<meta property="article:author" content="Zitao">
<meta property="article:tag" content="Geofencing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zitao0206.github.io/assets/iOS/Projects&Issues/000.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>01. How to use iOS Geofencing in your business?</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/categories">Categories</a></li><!--
     --><!--
       --><li><a href="/tags">Tags</a></li><!--
     --><!--
       --><li><a href="/search">Search</a></li><!--
     --><!--
       --><li><a href="/archives">Archives</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/zitao0206">Projects</a></li><!--
     --><!--
       --><li><a href="/about">Others</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/10/08/Reactive%20Programming/01.%20Combine/01.%20Combine%20(1)/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2023/10/04/Reactive%20Programming/01.%20Combine/00.%20Combine%20(0)/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&text=01. How to use iOS Geofencing in your business?"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&is_video=false&description=01. How to use iOS Geofencing in your business?"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=01. How to use iOS Geofencing in your business?&body=Check out this article: https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&name=01. How to use iOS Geofencing in your business?&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&t=01. How to use iOS Geofencing in your business?"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Background"><span class="toc-number">1.</span> <span class="toc-text">1. Background</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Principles-of-Geofencing"><span class="toc-number">2.</span> <span class="toc-text">2. Principles of Geofencing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Application-of-business-scenarios"><span class="toc-number">3.</span> <span class="toc-text">3. Application of business scenarios</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Cautions"><span class="toc-number">4.</span> <span class="toc-text">4. Cautions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        01. How to use iOS Geofencing in your business?
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Zitao</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-10-06T10:00:00.000Z" class="dt-published" itemprop="datePublished">2023-10-06</time>
        
        (Updated: <time datetime="2023-12-15T14:25:13.041Z" class="dt-updated" itemprop="dateModified">2023-12-15</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/iOS/">iOS</a> › <a class="category-link" href="/categories/iOS/Projects-Issues/">Projects & Issues</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Geofencing/" rel="tag">Geofencing</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><font color=gray size=2><em>It will take about 10 minutes to finish reading this article.</em></font></p>
<p>Here is a summary of all the possible reasons for publishing failure in Hexo.</p>
<h4 id="1-Background"><a href="#1-Background" class="headerlink" title="1. Background"></a><font size=3 color=#4169E1>1. Background</font></h4><p>There was once such a requirement scenario, when the user walks into the neighborhood of a shop, we can send the user and the shop related to the push message, so as to attract traffic for the business. This kind of requirement is actually very common, especially for local life business.</p>
<p>For this kind of requirement, the more common solution is to continuously obtain the latitude and longitude of the user’s current location and report it to the back-end, which will then calculate and determine whether the user has entered the area that has been marked out in advance, and if he&#x2F;she has entered the area, then send a remote notification to the user.</p>
<p>Since the business was brand new, the service side downgraded the priority of this project due to manpower constraints and it could not be scheduled until a long time. At the same time, our product manager had some urgent needs to support this feature. After discussion, we prioritized Region Monitoring on iOS, and the service side only needed to spare less manpower to support it.</p>
<p>Therefore, Core Location provided Region Monitoring to realize this requirement, which was a temporary solution and depended too much on the client-side logic, but for a brand new business, a lot of things needed to be verified with less cost, so Region Monitoring played its role at this time.</p>
<p>This article was briefly written years ago:</p>
<p><a target="_blank" rel="noopener" href="https://leon0206.blog.csdn.net/article/details/54670446">https://leon0206.blog.csdn.net/article/details/54670446</a></p>
<p>This time it is part of a content update.</p>
<h4 id="2-Principles-of-Geofencing"><a href="#2-Principles-of-Geofencing" class="headerlink" title="2. Principles of Geofencing"></a><font size=3 color=#4169E1>2. Principles of Geofencing</font></h4><p><font size=3 color=#4169E1><strong>2.1 Prerequisites</strong></font><br>The Geofencing feature is a sub-function of CLLocationManager, so its trigger callbacks are also in the callbacks of CLLocationManagerDelegate. If you want to trigger these callbacks, you need to meet some of the conditions, in the official Apple documentation is also introduced, you need to meet the following conditions before you can use it:</p>
<img src="/assets/iOS/Projects&Issues/000.png" class="">   

<p>To summarize:</p>
<p>(1) The user’s phone has the hardware required for area monitoring (GPS, sufficient battery, Wifi, etc.);</p>
<p>(2) The user has enabled location-related services (“Always” or “When in use” permission, background application refresh, etc.);</p>
<p>Of course we can call CLLocationManager’s isMonitoringAvailableFor: class method and authorizationStatus() to tell the availability of the Region Monitoring feature.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="type">CLLocationManager</span>.isMonitoringAvailable(for: <span class="type">CLCircularRegion</span>.<span class="keyword">self</span>) &#123;</span><br><span class="line">    <span class="comment">// Circular geofence monitoring is available</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> authorizationStatus <span class="operator">=</span> <span class="type">CLLocationManager</span>.authorizationStatus()</span><br><span class="line"><span class="keyword">if</span> authorizationStatus <span class="operator">==</span> .authorizedAlways &#123;</span><br><span class="line">    <span class="comment">// Authorized to access location information at all times</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font size=3 color=#4169E1><strong>2.2 CLCircularRegion</strong></font></p>
<p>Geofencing monitoring starts with setting up a circle to monitor, which is defined as a CLCircularRegion with a center coordinate and a radius in meters, and an identifier as the key value.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="keyword">class</span> <span class="title class_">CLCircularRegion</span> : <span class="title class_">CLRegion</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     *  initWithCenter:radius:identifier:</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *  Discussion:</span></span><br><span class="line"><span class="comment">     *    Initialize a region.  center gives the coordinates of center of the region, while radius gives</span></span><br><span class="line"><span class="comment">     *    the distance in meters between the center and the region&#x27;s boundary. identifier is a description</span></span><br><span class="line"><span class="comment">     *    for the region that could be displayed to the user, and ideally should be chosen by the user.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(<span class="params">center</span>: <span class="type">CLLocationCoordinate2D</span>, <span class="params">radius</span>: <span class="type">CLLocationDistance</span>, <span class="params">identifier</span>: <span class="type">String</span>)</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Note: identifier is the unique identifier of the region, if the added region has the same identifier, the new region will replace the old one.</p>
<p><font size=3 color=#4169E1><strong>2.3 Registered Area Monitors</strong></font></p>
<p>For a Region to be monitored, it first needs to be registered and an already registered Region can also be stopped.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">startMonitoring</span>(<span class="params">for</span> <span class="params">region</span>: <span class="type">CLRegion</span>)</span><br><span class="line"><span class="keyword">func</span> <span class="title function_">stopMonitoring</span>(<span class="params">for</span> <span class="params">region</span>: <span class="type">CLRegion</span>)</span><br></pre></td></tr></table></figure>


<p><font size=3 color=#4169E1><strong>2.4 Region Monitor</strong></font></p>
<p>When iOS devices can listen for users entering or leaving a circular fence area. The entrance event fires when the user moves from outside the circle to inside the circle.</p>
<p>At the same time, the exit event fires when the user leaves the circular area, as shown in the following figure:</p>
<img src="/assets/iOS/Projects&Issues/001.png" class="">   

<img src="/assets/iOS/Projects&Issues/002.png" class="">   

<p>Note 1:<br>After registering an area, you can start monitoring immediately, but you won’t receive the event immediately, because the event must be triggered by “boundary crossings”, that is, you have to cross into or out of an area to trigger the event, and the corresponding callback function will be triggered as well:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">locationManager</span>(<span class="keyword">_</span> <span class="params">manager</span>: <span class="type">CLLocationManager</span>, <span class="params">didEnterRegion</span> <span class="params">region</span>: <span class="type">CLRegion</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> circularRegion <span class="operator">=</span> region <span class="keyword">as?</span> <span class="type">CLCircularRegion</span> &#123;</span><br><span class="line">        handleRegionEvent(circularRegion)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">locationManager</span>(<span class="keyword">_</span> <span class="params">manager</span>: <span class="type">CLLocationManager</span>, <span class="params">didExitRegion</span> <span class="params">region</span>: <span class="type">CLRegion</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> circularRegion <span class="operator">=</span> region <span class="keyword">as?</span> <span class="type">CLCircularRegion</span> &#123;</span><br><span class="line">        handleRegionEvent(circularRegion)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">handleRegionEvent</span>(<span class="keyword">_</span> <span class="params">region</span>: <span class="type">CLCircularRegion</span>) &#123;</span><br><span class="line">    <span class="comment">// Code to handle entry or exit zone events</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Note 2:</p>
<p>You can use the CLLocationManager’s Request Status Information for Specified Region method to check if the user is already in a region:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Request state information for the specified region</span></span><br><span class="line">locationManager.requestState(for: region)</span><br></pre></td></tr></table></figure>

<p>When a user enters or leaves the monitored area, if the app is not executing, the app will be relaunched in Backgroud to handle the triggered entry and exit actions.</p>
<p>If the app is suspended in the background, the app will be wokenup for a short period of time (about 10 seconds, more background execution time can be requested if necessary).</p>
<p>Careful people must think, if there is a user in the boundary of the non-stop “wandering”, will not always start callbacks, for this case, Apple also has a corresponding solution, as follows:</p>
<img src="/assets/iOS/Projects&Issues/003.png" class="">   

<p>The explanation is:</p>
<p>Region events may not occur immediately after a region boundary is crossed. To prevent false notifications, iOS does not send region notifications until a specific threshold condition is met. Specifically, the user’s location must cross the region boundary, be a minimum distance away from the boundary, and maintain that minimum distance for at least 20 seconds before a notification is sent.</p>
<p><font size=3 color=#4169E1><strong>2.5 Demo</strong></font></p>
<p>Here we look at a demo demo, this demo is the code address has been noted below, you can download.</p>
<p>(1) in the map area register a center for 31.239394,121.499781, radius of 2000 meters of the area, as follows:</p>
<img src="/assets/iOS/Projects&Issues/004.png" class=""> 

<p>(2) Change the location of the analog positioning to 31.259394,121.499781 as follows:</p>
<img src="/assets/iOS/Projects&Issues/005.png" class=""> 

<p>(3) At this time we again change the current location latitude and longitude to: 31.240394,121.499781, has entered the detected area, as follows:</p>
<img src="/assets/iOS/Projects&Issues/006.png" class=""> 

<p>(4) Similarly, if we cut the app to the background or kill it and change the current location, we can still receive local local notifications as follows:</p>
<img src="/assets/iOS/Projects&Issues/007.png" class=""> 



<p><font size=3 color=#4169E1><strong>2.6 Regions limit</strong></font></p>
<p>Apple’s official document points out that each app can monitor up to 20 regions, and the monitored regions are shared system resources, while the number of monitoring provided by the whole system is limited. For this limitation, one strategy given by Apple is to set different regions according to the user’s current location, and after the user changes the location, remove the far away region and set a new region. If you go beyond 20 and continue to add, a fail callback will be executed to you:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="operator">-</span> (void)locationManager:(<span class="type">CLLocationManager</span> <span class="operator">*</span>)manager</span><br><span class="line">  monitoringDidFailForRegion:(nullable <span class="type">CLRegion</span> <span class="operator">*</span>)region</span><br><span class="line">  withError:(<span class="type">NSError</span> <span class="operator">*</span>)error &#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="3-Application-of-business-scenarios"><a href="#3-Application-of-business-scenarios" class="headerlink" title="3. Application of business scenarios"></a><font size=3 color=#4169E1>3. Application of business scenarios</font></h4><p>How to use the specific also need to be based on business scenarios to decide, I suggest the following based on our previous business dynamics (this should be the most complex scenarios):</p>
<p>(1)  Server-side distribution strategy of Regions</p>
<p>A user’s path we can not predict, so the Regions should take a hierarchical trigger. For example, the first to send a few default province-level large Regions (Zhejiang, Jiangsu, Anhui, etc.), if the user triggers one of the Region (Zhejiang), then you can dynamically update the Regions again for the city-level Region in Zhejiang Province, the next time you trigger a city (Hangzhou) of the Region, you can once again update the regional level of the Region. Region…</p>
<p>(2) Note that the specific implementation of</p>
<p>Regions need to be cached (expiration time), the interface needs to be issued Regions trigger strategy to avoid redundant startup requests; Regions identifier to avoid duplication, if it involves multiple businesses, it is best to distinguish the prefixes; Regions if the trigger is not needed, please stop; Regions monitor is recommended to have a global switch, the next time the trigger is a city (Hangzhou) Region, you can update the region again. monitor suggests that there is a global switch, you can server-side control off and on.</p>
<h4 id="4-Cautions"><a href="#4-Cautions" class="headerlink" title="4. Cautions"></a><font size=3 color=#4169E1>4. Cautions</font></h4><p>Firstly, Turning on this feature will set off the background refresh of the app, and the app will become very power-consuming (LocationManager itself is very power-consuming), which may not be a good experience for the user; so you need to be careful to turn on this feature, turn it on in time, and the related parameters (location accuracy precision and monitor’s radius) need to be more refined.</p>
<p>Secondly, Region monitor, like some Push services, will wake up the app in not running or suspend state to backgroud state, during which it will execute the application:didFinishLaunchingWithOptions: method in AppDelegate. : method, the following implications may exist here:</p>
<p>(1) If your application adds a large code base to didFinishLaunching without categorizing the application launching scenarios, there may be some problems. For example, your logging system may record this as a cold launch event, which will affect your user activity statistics.</p>
<p>(2) Because the app may only exist in backgroud state and does not need to load all the codebase, it is recommended to optimize it in separate scenarios from the point of view of sex consumption.</p>
<p>(3) Here is a test demo for the OC version of RW: <a target="_blank" rel="noopener" href="https://github.com/942v/Geotify-RW">https://github.com/942v/Geotify-RW</a>.</p>
<h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><font size=3 color=gray><em>Reference</em></font></h4><p>[1] <a target="_blank" rel="noopener" href="https://www.kodeco.com/17649843-geofencing-with-core-location-getting-started">https://www.kodeco.com/17649843-geofencing-with-core-location-getting-started</a><br>[2] <a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/LocationAwarenessPG/RegionMonitoring/RegionMonitoring.html">https://developer.apple.com/library/archive/documentation/UserExperience/Conceptual/LocationAwarenessPG/RegionMonitoring/RegionMonitoring.html</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/categories">Categories</a></li>
        
          <li><a href="/tags">Tags</a></li>
        
          <li><a href="/search">Search</a></li>
        
          <li><a href="/archives">Archives</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/zitao0206">Projects</a></li>
        
          <li><a href="/about">Others</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Background"><span class="toc-number">1.</span> <span class="toc-text">1. Background</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Principles-of-Geofencing"><span class="toc-number">2.</span> <span class="toc-text">2. Principles of Geofencing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Application-of-business-scenarios"><span class="toc-number">3.</span> <span class="toc-text">3. Application of business scenarios</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Cautions"><span class="toc-number">4.</span> <span class="toc-text">4. Cautions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&text=01. How to use iOS Geofencing in your business?"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&is_video=false&description=01. How to use iOS Geofencing in your business?"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=01. How to use iOS Geofencing in your business?&body=Check out this article: https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&title=01. How to use iOS Geofencing in your business?"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&name=01. How to use iOS Geofencing in your business?&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zitao0206.github.io/2023/10/06/iOS/05.%20Projects%20&amp;%20Issues/01.%20How%20to%20use%20iOS%20Geofencing%20in%20your%20business/&t=01. How to use iOS Geofencing in your business?"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2023-2033
    Zitao
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/categories">Categories</a></li><!--
     --><!--
       --><li><a href="/tags">Tags</a></li><!--
     --><!--
       --><li><a href="/search">Search</a></li><!--
     --><!--
       --><li><a href="/archives">Archives</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/zitao0206">Projects</a></li><!--
     --><!--
       --><li><a href="/about">Others</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->


 
  <link
    rel="preload"
    href="/lib/font-awesome/css/all.min.css"
    as="style"
    onload="this.onload=null;this.rel='stylesheet'"
  />
  <noscript
    ><link
      rel="stylesheet"
      href="/lib/font-awesome/css/all.min.css"
  /></noscript>


    <!-- jquery -->

  
<script src="/lib/jquery/jquery.min.js"></script>





<!-- clipboard -->

  
    
<script src="/lib/clipboard/clipboard.min.js"></script>

  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
